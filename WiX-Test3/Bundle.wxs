<?xml version="1.0" encoding="UTF-8"?>

<!-- Dieses WXS-Skript basiert auf dem Beispielscript unter https://www.firegiant.com/wix/tutorial/net-and-net/bootstrapping/ -->
  
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:bal="http://schemas.microsoft.com/wix/BalExtension"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  
	<Bundle Name="WiX_Test3" 
          Condition="VersionNT = v6.1"
          Version="1.0.0.0" 
					Manufacturer="RalfSasse" 
					UpgradeCode="F2DA6640-395C-45B8-91CC-BEC2244640B9">
    
    <BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.RtfLicense" />

    <util:RegistrySearch Root="HKLM" 
                         Key="SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full" 
                         Value="Version" 
                         Variable="Net4FullVersion" />
    
    <util:RegistrySearch Root="HKLM" 
                         Key="SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full" 
                         Value="Version" 
                         Variable="Net4x64FullVersion" 
                         Win64="yes" />

    <Chain>

      <ExePackage Id="Net48" 
                  Name="Microsoft .NET Framework 4.8 Setup" 
                  Cache="no" 
                  Compressed="yes" 
                  PerMachine="yes" 
                  Permanent="yes" 
                  Vital="yes" 
                  InstallCommand="/q"
                  SourceFile="ndp48-x86-x64-allos-enu.exe"
                  DetectCondition="Net4FullVersion AND (NOT VersionNT64 OR Net4x64FullVersion)"
                  InstallCondition="(VersionNT &lt; v6.0 OR VersionNT64 &lt; v6.0) AND (NOT (Net4FullVersion OR Net4x64FullVersion))" />

      <RollbackBoundary />

      <MsiPackage Id="WiX_Test2" 
                  SourceFile="WiX-Test2.msi" 
                  DisplayInternalUI="yes" 
                  Compressed="yes" 
                  Vital="yes" />
    
    </Chain>
  
  </Bundle>
</Wix>
